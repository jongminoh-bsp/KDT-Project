# Terraform ë³€ìˆ˜ ë³´ì•ˆ ê°€ì´ë“œ

## ğŸ”’ ë³€ìˆ˜ ë³´ì•ˆ ë¶„ë¥˜

### âœ… ì•ˆì „í•œ ë³€ìˆ˜ (tfvars íŒŒì¼ì— ì €ì¥ ê°€ëŠ¥)

#### ì¸í”„ë¼ ë©”íƒ€ë°ì´í„°
- `region`: AWS ë¦¬ì „ (ê³µê°œ ì •ë³´)
- `project`, `environment`: í”„ë¡œì íŠ¸ ì‹ë³„ì
- `cluster_name`: EKS í´ëŸ¬ìŠ¤í„° ì´ë¦„ (ê³µê°œ)
- `cluster_version`: Kubernetes ë²„ì „ (ê³µê°œ)

#### ë¦¬ì†ŒìŠ¤ ì„¤ì •
- `instance_type`: EC2 ì¸ìŠ¤í„´ìŠ¤ íƒ€ì… (ê³µê°œ)
- `ami_id`: AMI ID (ê³µê°œ)
- `db_name`: ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ (ì¼ë°˜ì ìœ¼ë¡œ ë¹„ë¯¼ê°)
- `db_username`: ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ìëª… (ì¼ë°˜ì ìœ¼ë¡œ ë¹„ë¯¼ê°)

#### ë„¤íŠ¸ì›Œí¬ ì„¤ì •
- `vpc_cidr`: VPC CIDR ë¸”ë¡
- `subnet_cidrs`: ì„œë¸Œë„· CIDR ë¸”ë¡ë“¤
- RDS endpoint (ìë™ ìƒì„±, ê³µê°œ ì •ë³´)

### âš ï¸ ì£¼ì˜ê°€ í•„ìš”í•œ ë³€ìˆ˜

#### EC2 í‚¤í˜ì–´
```hcl
# í˜„ì¬ ë°©ì‹ (í—ˆìš©ë˜ì§€ë§Œ ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
key_name = "ojm-key"

# ê¶Œì¥ ë°©ì‹: SSM Session Manager ì‚¬ìš©
# EC2 ì¸ìŠ¤í„´ìŠ¤ì— í‚¤í˜ì–´ ì—†ì´ ì ‘ê·¼
```

#### íƒœê·¸ ì •ë³´
```hcl
# ì¡°ì§ êµ¬ì¡°ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìŒ
common_tags = {
  Owner       = "team-name"  # íŒ€ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥
  CostCenter  = "12345"      # ë¹„ìš© ì„¼í„° ì •ë³´
}
```

### âŒ ì ˆëŒ€ ë³€ìˆ˜ë¡œ ë‘ë©´ ì•ˆ ë˜ëŠ” ê²ƒë“¤

#### ì¸ì¦ ì •ë³´
- `db_password`: âœ… AWS Secrets Managerë¡œ ì´ë™ ì™„ë£Œ
- API í‚¤, í† í°
- ì¸ì¦ì„œ ë‚´ìš©
- SSH í”„ë¼ì´ë¹— í‚¤

#### ë¯¼ê°í•œ ë„¤íŠ¸ì›Œí¬ ì •ë³´
- VPN ì„¤ì •
- ë‚´ë¶€ IP ì£¼ì†Œ (ê²½ìš°ì— ë”°ë¼)
- ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ì˜ íŠ¹ì • IP (ê²½ìš°ì— ë”°ë¼)

## ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™” ë°©ë²•

### 1. AWS Secrets Manager í™œìš©
```hcl
# í˜„ì¬ êµ¬í˜„ (ì˜¬ë°”ë¦„)
resource "aws_secretsmanager_secret" "rds_password" {
  name = "${var.name_prefix}-rds-password"
}

resource "random_password" "rds_password" {
  length  = 16
  special = true
}
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©
```bash
# ë¯¼ê°í•œ ì •ë³´ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ
export TF_VAR_key_name="ojm-key"
terraform apply
```

### 3. .gitignore ì„¤ì •
```gitignore
# ì´ë¯¸ ì„¤ì •ë¨
*.tfvars
!terraform.tfvars.example
terraform.tfstate*
.terraform/
```

### 4. Terraform Cloud/Enterprise ì‚¬ìš©
```hcl
# ë¯¼ê°í•œ ë³€ìˆ˜ë¥¼ UIì—ì„œ ê´€ë¦¬
variable "sensitive_data" {
  description = "Sensitive information"
  type        = string
  sensitive   = true
}
```

## ğŸ“‹ í˜„ì¬ í”„ë¡œì íŠ¸ ë³´ì•ˆ ìƒíƒœ

### âœ… ì˜ êµ¬í˜„ëœ ë¶€ë¶„
- íŒ¨ìŠ¤ì›Œë“œë¥¼ Secrets Managerë¡œ ì´ë™
- .gitignoreì— ë¯¼ê°í•œ íŒŒì¼ ì œì™¸
- terraform.tfvars.example ì œê³µ

### ğŸ”„ ê°œì„  ê°€ëŠ¥í•œ ë¶€ë¶„
- EC2 í‚¤í˜ì–´ â†’ SSM Session Manager ì „í™˜ ê³ ë ¤
- í™˜ê²½ë³„ ë³€ìˆ˜ ë¶„ë¦¬ (dev/staging/prod)
- Terraform Cloud ë„ì… ê²€í† 

## ğŸ’¡ ê¶Œì¥ì‚¬í•­

### ì¦‰ì‹œ ì ìš© ê°€ëŠ¥
1. **ì£¼ì„ ì¶”ê°€**: ê° ë³€ìˆ˜ì˜ ë³´ì•ˆ ìˆ˜ì¤€ ëª…ì‹œ
2. **ë¬¸ì„œí™”**: ë³´ì•ˆ ê°€ì´ë“œë¼ì¸ íŒ€ ê³µìœ 
3. **ì •ê¸° ê²€í† **: ë¶„ê¸°ë³„ ë³´ì•ˆ ë³€ìˆ˜ ì ê²€

### ì¥ê¸° ê³„íš
1. **SSM Session Manager**: EC2 í‚¤í˜ì–´ ì˜ì¡´ì„± ì œê±°
2. **í™˜ê²½ ë¶„ë¦¬**: dev/staging/prod ë³€ìˆ˜ ë¶„ë¦¬
3. **ìë™í™”**: ë¯¼ê°í•œ ì •ë³´ ìë™ ë¡œí…Œì´ì…˜

## ğŸ” ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] íŒ¨ìŠ¤ì›Œë“œê°€ í‰ë¬¸ìœ¼ë¡œ ì €ì¥ë˜ì§€ ì•Šì•˜ëŠ”ê°€?
- [ ] API í‚¤ê°€ ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì§€ ì•Šì•˜ëŠ”ê°€?
- [ ] .gitignoreì— ë¯¼ê°í•œ íŒŒì¼ì´ ì œì™¸ë˜ì—ˆëŠ”ê°€?
- [ ] ë³€ìˆ˜ì— sensitive = true í”Œë˜ê·¸ê°€ ì ì ˆíˆ ì„¤ì •ë˜ì—ˆëŠ”ê°€?
- [ ] íŒ€ì›ë“¤ì´ ë³´ì•ˆ ê°€ì´ë“œë¼ì¸ì„ ìˆ™ì§€í–ˆëŠ”ê°€?

í˜„ì¬ êµ¬ì¡°ëŠ” ë³´ì•ˆìƒ ì ì ˆí•©ë‹ˆë‹¤. db_name, db_username, RDS endpointëŠ” ë³€ìˆ˜ë¡œ ë‘ì–´ë„ ì•ˆì „í•©ë‹ˆë‹¤!
